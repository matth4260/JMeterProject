FROM centos:7

RUN yum install wget -y
RUN wget https://dl.influxdata.com/influxdb/releases/influxdb-1.7.10.x86_64.rpm
RUN yum localinstall influxdb-1.7.10.x86_64.rpm -y


COPY influxdb.conf /influxdb.conf 
COPY scriptInfluxdb.sh /scriptInfluxdb.sh
RUN chmod +x /scriptInfluxdb.sh

RUN mkdir /var/lib/influxdb/meta
RUN chgrp 0 /var/lib/influxdb && \
    chmod -R g=u /var/lib/influxdb

RUN chmod g=u /etc/passwd
USER 1001

EXPOSE 8086
EXPOSE 8088
EXPOSE 2003

ENTRYPOINT ["/scriptInfluxdb.sh"]
